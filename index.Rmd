---
title: "SQL"
output: html_document
---

## Filtering coulumns and Rows

With SQL, you can filter columns and row by using SELECT and WHERE. Let's look at an example using the Lahman database. So we could first load that database, along with the package sqldf.

```{r message = FALSE, warning = FALSE}
library(Lahman)
library(sqldf)
```

Suppose now I would like to see the homerun totals for the 1927 Yankees. I could write the following query.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='NYA' and yearID=1927"
sqldf(query)
```

Suppose now I would like to find all the instances where a player had more than 40 HR but less than 60 strikeouts (SO).

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='NYA' and HR>=40"
sqldf(query)
```

Suppose now I would like to find all the instances where a player had more than 40 HR but less than 60 strikeouts (SO).

```{r}
query<-"SELECT playerID,yearID,teamID,HR,SO FROM Batting
WHERE HR>40 and SO<60"
sqldf(query)
```

Suppose now I would like to find all instances of the Phillies (PHI) in the 1970's hitting more than 30 HR's.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE teamID='PHI' and HR>30 and yearID<=1979 and yearID>=1970"
sqldf(query)
```

Suppose now I would like to find every instance of a player hitting more than 50 homeruns. Let's have the players with the highest homerun total at the top.

```{r}
query<-"SELECT playerID,yearID,teamID,HR FROM Batting
WHERE HR>50
ORDER BY HR DESC"
sqldf(query)
```

